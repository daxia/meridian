---
doc_type: prd
doc_id: PRD-API-核心服务需求
owner: backend
related_requirement:
  - 我的需求
created: 2026-02-14
updated: 2026-02-14
---

# 产品需求文档（PRD）：核心服务需求

**需求来源**：docs/01-我的需求/我的需求.md

本文档负责 **Backend API & Workflows** 相关的核心业务逻辑需求。

---

## 2. 变更记录

- **2026-02-14**:
  - **需求编号**: 20260214007
  - **内容**: 新增情报汇总自动化流程需求。
  - **目标**: 实现从文章抓取到生成日报的全链路自动化。

---

## 需求1：情报汇总自动化流程 (已完成)

**需求编号**: 20260214007

**DD编号**: DD-API-核心服务需求

### 1. 需求功能点

**1）定时触发汇总**:

- **描述**: 系统应具备定时任务（Cron），定期（例如每天 06:00, 18:00）触发情报汇总工作流。
- **验收标准**: 到达预定时间后，系统自动创建 `GenerateBriefWorkflow` 实例，并在日志中记录。

**2）汇总生成工作流 (Workflow)**:

- **描述**: `GenerateBriefWorkflow` 需按顺序执行：
    1.  **Fetch**: 从数据库查询过去 N 小时内未处理的文章。
    2.  **Cluster**: 调用 ML Service 对文章进行聚类。
    3.  **Summarize**: 调用 LLM 对聚类结果进行总结。
    4.  **Save**: 将生成的 Brief 存入 `reports` 表。
- **验收标准**: 工作流能成功跑通，数据库中生成新的 Report 记录。

### 2. 目标与约束

- **目标**: 消除人工介入，实现全自动化的日报生成。
- **约束**: Cloudflare Workers 的 CPU 时间限制；LLM API 的 Token 消耗控制。

### 3. 当前实现分析

目前系统仅完成了 RSS 抓取和单篇文章的向量化。缺少将分散文章“串”起来生成报告的逻辑。`start_all.js` 启动了 ML 服务，但后端尚未调用其聚类接口（接口可能也不存在）。

### 4. 需求审核疑问

（无）

### 5. 需求审核结论

**审核结果**: 批准
**审核日期**: 2026-02-14
**结论**: 核心功能缺失，必须补充。