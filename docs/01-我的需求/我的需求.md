
---

## 需求10. ML Service 日志格式优化 (2026-02-14)

**编号**：20260214010
**状态**：待实现
**关联 PRD**：PRD-SYS-日志功能需求
**关联 DD**：DD-SYS-日志功能需求

### 10.1 用户原始需求内容

`ML Service` 的日志文件中包含 JSON 格式的日志行，如：
`[2026-02-14 13:04:20] {"timestamp": "...", "level": "info", "message": "42 changes detected", ...}`

需要将这些 JSON 日志解析并转换为标准的文本格式，使其与其他服务的日志风格保持一致。按照标准日志打印，并遵循开发流程。

### 10.2 Agent 整理后需求内容

- **范围**: 系统基础设施 (`start_all.js`)。
- **关键点**:
    - **JSON 检测与解析**: 在 `start_all.js` 的日志处理流中，检测每行日志是否为 JSON 格式。
    - **格式化**: 如果是 JSON 且包含 `level` 和 `message` 字段，将其转换为标准格式 `[LEVEL] Message`。
    - **保留时间戳**: 使用 `start_all.js` 统一注入的外部时间戳，忽略或参考内部 JSON 时间戳（为保持一致性，建议使用外部注入的时间戳）。
    - **目标格式**: `[YYYY-MM-DD HH:mm:ss] [INFO] 42 changes detected`。
